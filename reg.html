<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <script type="text/javascript" src="js/md5.js" ></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <script type="text/javascript" charset="UTF-8">
      	mui.init();
      	(function($) {
      	$.ready(function() {
			mui.plusReady(function(){
      		document.getElementsByTagName("span")[0].addEventListener("tap",function(){
      			mui.openWindow({
      					url:"log0.html",
      					id:"log0"
      				})
      		})
      		document.getElementsByTagName("p")[0].addEventListener("tap",function(){
      			mui.openWindow({
      					url:"logForget.html",
      					id:"logForget",
      					createNew:true
      				})
      		})
      		document.getElementsByTagName("button")[0].addEventListener("tap",function(){
      			var num = document.getElementById("num").value;
      			var pass = document.getElementById("pass").value;
      			document.getElementsByClassName("back")[0].className="back"
      			document.getElementById("num").value="";
      			document.getElementById("pass").value=""
      			logIn(num,pass);

      		})
      		function logIn(loginId,userPw) {
				var array = [loginId,userPw,ts,rn];
				var cVal=getcval(array);
				var url=""+rooturl+"/user/login.bl?loginId="+loginId+"&userPw="+userPw+"&cVal="+cVal+"&ts="+ts+"&rn="+rn;
				console.log(url)
				if ( xhr ) {
					return;
				}
				var xhr = new plus.net.XMLHttpRequest();
				xhr.onreadystatechange = function () { 
			        switch ( xhr.readyState ) {
			            case 4:
			                console.log( "xhr请求已"+rn+"完成"+ts);
			                if ( xhr.status == 200 ) {
			                	chake(xhr.response.code,xhr.response.cVal,xhr.response.body);
			                	if(xhr.response.code=="101"){
				                	document.getElementsByClassName("back")[0].className="back backHide"
									if(xhr.response.body.statusCode=="login_success"){
										window.localStorage.userNm=xhr.response.body.userNm;
										window.localStorage.headPic=xhr.response.body.headPic;
										window.localStorage.mobileNo=xhr.response.body.mobileNo;
										window.localStorage.realNameAuthYn=xhr.response.body.realNameAuthYn;
										window.localStorage.feedbackUrl=xhr.response.body.feedbackUrl;
										window.localStorage.lockerd='';
										mui.openWindow({
						      				url:"locker.html",
						      				id:"locker"
						      			}); 
									}else{
										alert(xhr.response.body.statusMessage);
									}
								}else{
									alert("错误代码"+xhr.response.code);
								}
			                } else {
			                	
			                }
			                break;
			            default :
			                break;
			        }
				}
				xhr.open( "POST", url );
				xhr.responseType="json";
				xhr.send();
			}
      	});
      	});
	})(mui);
    </script>
    <style type="text/css">
    	*{margin: 0;padding: 0;list-style: none;font-weight: 400;font-family: "微软雅黑";}
    	.mui-bar{background: #DD524D;box-shadow: none;border-bottom:1px solid #ccc;}
    	.mui-bar a,.mui-bar .mui-title,.mui-bar{color: #fff;}
    	
    	.mui-content{float: left;width: 100%;margin-top: 10px;}
    	.mui-content input{width: 100%;float: left;margin: 0;}
    	.mui-content #num{border-bottom: none;}
    	.mui-content button{width: 90%;float: left;margin-left: 5%;margin-top: 20px;}
    	.mui-content p{float: left;width: 50%;text-align: left;padding-left: 5%;font-size: 12px;margin-top: 10px;}
    	.mui-content span{float: left;width: 50%;text-align: right;padding-right: 5%;font-size: 12px;color: #DD524D;margin-top: 10px;}
    	.back{position: fixed;height: 100%;width: 100%;z-index: 100;background: rgba(0,0,0,0.2);}
    	.backHide{display: none;}
    </style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		 <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	    <h1 class="mui-title">登录</h1>
	</header>
	<div class="back backHide"></div>
	<div class="mui-content">
	    <input type="text" placeholder="手机号码/用户名/邮箱" id="num"/>
	    <input type="password" placeholder="请输入您的密码" id="pass"/>
	    <button type="button" class="mui-btn mui-btn-danger">登陆</button>
	    <p>忘记密码</p><span>免费注册</span>
	</div>
</body>
</html>